{"version":3,"sources":["../../src/renderer/Rooms.jsx"],"names":["ICON_CHAT_STYLE","fontSize","color","FORM_STYLE","display","BUTTON_STYLE","marginLeft","Rooms","props","state","roomName","rooms","db","database","handleOnChangeRoomName","bind","handleOnSubmit","fetchRooms","e","setState","target","value","preventDefault","length","newRoomRef","ref","push","newRoom","description","update","then","key","limitToLast","once","snapshot","forEach","console","log","item","Object","assign","val","roomId","params","map","r","children","renderRoomList","renderRoom","Component"],"mappings":"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","file":"Rooms.js","sourcesContent":["import React from \"react\";\nimport { hashHistory } from \"react-router\";\nimport RoomItem from \"./RoomItem\";\nimport firebase from \"firebase/firebase-browser\";\n\nconst ICON_CHAT_STYLE = {\n\tfontSize: 120,\n\tcolor: '#DDD'\n}\n\nconst FORM_STYLE = {\n\tdisplay: 'flex'\n}\n\nconst BUTTON_STYLE = {\n\tmarginLeft: 10\n}\n\nexport default class Rooms extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\troomName: \"\",\n\t\t\trooms: []\n\t\t};\n\t\tthis.db = firebase.database();\n\t\tthis.handleOnChangeRoomName = this.handleOnChangeRoomName.bind(this);\n\t\tthis.handleOnSubmit = this.handleOnSubmit.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\t// コンポーネントの初期化時にチャットルームの一覧を取得\n\t\tthis.fetchRooms();\n\t}\n\n\thandleOnChangeRoomName(e) {\n\t\tthis.setState({ roomName: e.target.value });\n\t}\n\n\n\t// 新規チャットルームの作成処理\n\thandleOnSubmit(e) {\n\t\tconst { roomName } = this.state;\n\t\te.preventDefault();\n\t\tif(!roomName.length) {\n\t\t\treturn;\n\t\t}\n\t\t// Firebaseデータベースに新規チャットルームのデータ作成\n\t\tconst newRoomRef = this.db.ref(\"/chatrooms\").push();\n\t\tconst newRoom = {\n\t\t\tdescription: roomName\n\t\t};\n\t\t// 作成したチャットルームのdescription更新\n\t\tnewRoomRef.update(newRoom).then(() => {\n\t\t\t// 状態を再初期化\n\t\t\tthis.setState({ roomName: \"\"});\n\t\t\t// チャットルーム一覧を再取得\n\t\t\treturn this.fetchRooms().then(() => {\n\t\t\t\t// 右ペインを作成した詳細画面に遷移させる\n\t\t\t\thashHistory.push(`/rooms/${newRoomRef.key}`);\n\t\t\t});\n\t\t});\n\t}\n\n\t// チャットルーム一覧の取得処理\n\tfetchRooms() {\n\t\t// Firebaseデータベースからチャットルームを20件取得\n\t\treturn this.db.ref(\"/chatrooms\").limitToLast(20).once(\"value\").then(snapshot => {\n\t\t\tconst rooms = [];\n\t\t\tsnapshot.forEach(item => {\n\t\t\t\tconsole.log(item);\n\t\t\t\t// データベースから取得したデータをオブジェクトとして取り出す\n\t\t\t\trooms.push(Object.assign({ key: item.key }, item.val()));\n\t\t\t});\n\t\t\t// 取得したオブジェクトの配列をコンポーネントのstateにセット\n\t\t\tthis.setState({ rooms });\n\t\t});\n\t}\n\n\t// 左ペイン (チェットルーム一覧)の描画処理\n\trenderRoomList() {\n\t\tconst { roomId } = this.props.params;\n\t\tconst { rooms, roomName } = this.state;\n\t\tconsole.log(this.state);\n\t\treturn (\n\t\t\t<div className=\"list-group\">\n\t\t\t\t{rooms.map(r => <RoomItem room={r} key={r.key} selected={r.key === roomId} />)}\n\t\t\t\t<div className=\"list-group-header\">\n\t\t\t\t\t<form style={FORM_STYLE} onSubmit={this.handleOnSubmit}>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\tplaceholder=\"New room\"\n\t\t\t\t\t\t\tonChange={this.handleOnChangeRoomName}\n\t\t\t\t\t\t\tvalue={roomName}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button className=\"btn btn-default\" style={BUTTON_STYLE}>\n\t\t\t\t\t\t\t<span className=\"icon icon-plus\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t// 右ペイン\n\trenderRoom() {\n\t\tif (this.props.children) {\n\t\t\treturn this.props.children;\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t<div style={ICON_CHAT_STYLE}>\n\t\t\t\t\t\t<span className=\"icon icon-chat\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tjoin a chat room from the sidebar or create uour chat room.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t\t);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"pane-group\">\n\t\t\t\t<div className=\"pane-sm sidebar\">{this.renderRoomList()}</div>\n\t\t\t\t<div className=\"pane\">{this.renderRoom()}</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n"]}